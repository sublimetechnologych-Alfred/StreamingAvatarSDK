<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Alfred (voce rassicurante)</title>
</head>
<body>
  <h1>Alfred (voce rassicurante, ~67 anni)</h1>
  <div id="avatar" style="width: 480px; height: 360px; background: #000;"></div>
  <button onclick="startAlfred()">Avvia Alfred</button>

  <script type="module">
    async function startAlfred() {
      try {
        // 1. Crea sessione dal tuo backend su Vercel
        const resp = await fetch("/api/session", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            voice: "5c1ade5e514c4c6c900b0ded224970fd", // Theo - Friendly
            avatar: "default" // oppure un avatar ID valido
          })
        });

        const data = await resp.json();
        if (!resp.ok || !data || !data.data?.sdp) {
          throw new Error("Impossibile creare la sessione: " + JSON.stringify(data));
        }

        console.log("Sessione creata:", data);

        // 2. Mostra messaggio di test (puoi aggiungere streaming video più avanti)
        document.getElementById("avatar").innerHTML =
          "<p style='color:white; padding:20px'>Sessione avviata con Alfred ✅</p>";

      } catch (err) {
        alert("Errore: " + err.message);
        console.error(err);
      }
    }
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Alfred (voce rassicurante, ~67 anni)</title>
  <script src="https://unpkg.com/@heygen/streaming-avatar"></script>
</head>
<body>
  <h1>Alfred (voce rassicurante, ~67 anni)</h1>
  <div id="avatar" style="width: 640px; height: 480px; border: 1px solid #ccc;"></div>
  <button onclick="startAlfred()">Avvia Alfred</button>

  <script>
    async function startAlfred() {
      // 1️⃣ Chiediamo il session token alla nostra API su Vercel
      const resp = await fetch("/api/session");
      const { data } = await resp.json();
      const token = data.token;

      // 2️⃣ Avviamo HeyGen con session_token
      const client = new HeyGen.AvatarClient({
        el: document.getElementById("avatar"),
        token: token
      });

      await client.start({
        avatarName: "1837f93f22f94b88b9992853ca5e84f8", // Alfred
        voice: { voiceId: "en_us_001" },
        startText: "Ciao, sono Alfred. La tua guida rassicurante di 67 anni."
      });
    }
  </script>
</body>
</html>
